\chapter{Sarrera.}


\section{Ikerketaren testuingurua.}

Urte luzez, zientziaren arlo ezberdinek N-gorputzeko problema ikertu dute. Astronomoek eguzki-sistemaren planeten mugimendua ulertu nahian egindako lanak edo kimikariek erreakzio kimikoekin esperimentatzeko molekulen dinamikaren azterketak aipatu daitezke. Gainera,  N-gorputzen problemaren azterketak garrantzi berezia izan du matematikako eremu ezberdinen garapenean,  dinamika ez-lineal eta kaos teorian esaterako. 

Garai batean, N-gorputzen problemak teori analitikoen bidez aztertzen ziren baina konputagailuen sorrerarekin, zenbakizko integrazioak tresna nagusia bilakatu ziren. Azken hamarkadetan, bai konputazio teknologien aurrerapenari esker bai algoritmo berrien sorrerari esker, zenbakizko azterketek garapen handia izan dute. Zenbakizko simulazioen laguntzaz, eguzki-sistemaren dinamikaren funtsezko galdera batzuk ezagutu ditugu eta berriki, Karplusen taldeak 2013. urteko kimika Nobel saria \cite{Karplus2014} jaso du kimika konputazionalean egindako lanarengatik.       

Guk lan honetan, N-gorputzen problema grabitazionala aztertuko dugu. Oro har eta gaia kokatzeko asmoarekin, N-gorputzen ohiko zenbakizko  integrazioak hiru taldetan sailkatu ditzakegu:
\begin{enumerate}
{
\item Epe motzeko eta doitasun handiko integrazioak. 
 Eguzki-sistemaren efemeride zehatzak \cite{Folkner2014} edo espazioko satelite artifizialen kokapenen \cite{Beylkin2014} kalkuluetarako erabili ohi dira.
\item Epe luzeko baina doitasun txikiko integrazioak.
 Denbora epe luzean, planeta-sistemen mugimendua ezagutzeko egindako ikerketak dira. Azterketa hauetan, helburua gorputzen mugimenduaren argazkia orokorra (zehaztasun handirik gabe) ezagutzea da. Normalean, problema mota hauetan gorputzen arteko kolisio gertuko egoerak ez dira izaten.     
\item N-gorputz kopurua edozein izanik , hauen arteko kolisioak gerta daitezkeen problemak.
 Integrazio hauetan, konplexutasun handiari aurre egin behar zaio. N-gorputz kopurua miliotakoa \cite{Ishiyama2012} izan dateke eta kolisio gertuko egoeren ondorioz, kalkulutan egindako zenbakizko errore txikiek soluzioan eragin handia izan ditzakete.    
}
\end{enumerate}

Gure helburua, eguzki-sistemaren epe luzeko eta doitasun handiko integrazioetarako inplementazio eraginkorra garatzea da. Aurreko hamarkadetan, eguzki-sistemaren planeten epe luzeko zenbakizko integrazioa erronka garrantzitsua izan da. Adibidez, Sussmanek eta Wisdomek \ycite[1993]{Sussman1992} eguzki sistemaren 100 milioiko integrazioarekin, planeten mugimendua kaotikoa zela baieztatu zuten. Aldi berean, paleoklimatologi-zientziak orain milioika urte gertatutako klima zikloak (epel, hotz eta glaziazio aroak) azaltzeko, lurraren orbitan izandako aldaketaren eraginez gertatu zirela azaltzen duen teoria (Milankovitch 1941) \cite{Berger2012} baieztatzeko, planeten orbiten efemeride zehatzak beharrezkoak dira.        

Epe luzeko integrazio hauetarako zenbakizko hainbat metodo erabiltzen dira, bereziki beren izaera Hamiltondarra mantentzen duten metodoak (metodo sinplektikoak).

Konputazio-teknologi aurrerapenak handiak izan arren, eguzki-sistemaren simulazio hauek konputazionalki oso garestiak dira eta exekuzio denbora luzeak behar dituzte; adibidez, Laskarrek \ycite[2010]{Laskar2011} bere azken integrazioa burutzeko 18 hilabete behar izan zituen.
Azken urteotako konputagailu berrien arkitekturaren bilakaerak, algoritmo azkarren diseinua aldatu du: simulazioak azkartzeko algoritmoak paralelizazioan oinarritu behar dira. Azpimarratzekoa da ere, integrazio luze hauen erronka handienetako bat, biribiltze errorearen metaketa kontu handiz egitea da, non errorearen edozein joera ekiditzen den \cite{Laskar2015}.
 

\section{Motibazioa.}
\label{intro}


Metodo sinplektikoen artean, gehien erabiltzen direnak izaera esplizituko algoritmoak dira. Oro har problema zurruna ez bada, metodo esplizituak  metodo inplizituak baino eraginkorragoak dira. Metodo inplizituetan ekuazio sistema ez-lineala askatu behar da (eragiketa garestia), eta honek metodo esplizituekiko CPU denbora gainkarga suposatzen du. Horregatik problema zurruna ez denean, metodo esplizituak erabili ohi dira eta problema zurruna denean bakarrik jotzen dugu metodo inplizituengana. Epe luzeko eguzki-sistemaren integrazioetarako, baieztapen hau eztabaidagarria dela, eta praktikan metodo inplizituetan gehiago sakondu behar dela iruditzen zaigu. 

Lan honetan, Gauss zenbakizko integrazio metodo sinplektikoaren azterketa egin dugu. Hainbat autorek (Hairer \cite{Hairer2006}\cite{Hairer2008} eta Sanz Serna\cite{JMSanz-Serna1994}) metodo honen potentziala nabarmendu dute. Azken urtetan, espazioko satelite artifizialen arloan ere, Gauss integrazio metodo inplizituarekiko interesa azaldu dute \cite{Bradley2014}\cite{Beylkin2014}. 

Jarraian, Gauss metodo inplizituen ezaugarri interesgarri batzuk nabarmenduko ditugu. Abantaila nagusienetakoa malgutasuna da.  Metodo inplizituek inplementazio malgua onartzen dute eta ondorioz, integratu nahi dugun problemari egokitzeko eta eraginkortasuna hobetzeko aukera ezberdinak eskaintzen dizkigu. Aipatzekoa da ere, metodo esplizituak (sinplektikoak) sistema Hamiltondar banagarrietan bakarrik aplika daitezkeela eta orduan, Hamiltondarraren egitura hau aprobetxatuz oso eraginkorrak direla. Baina metodo inplizituak aldiz, Hamiltondar orokorrei aplika daitezke eta gainera, lehen ordenako ekuazio diferentzialetarako  metodo sinplektikoak, inplizituak izan behar dira. Gainera, Gauss metodoak paralelizagarriak dira, hau da, ekuazio diferentzial konplexuak kalkulatu behar ditugunean, $s$-ataletako funtzio konputazioak paraleloan exekutatu daitezke. Azkenik ez dugu ahaztu behar, orden altuko Gauss metodoak existitzen direla  eta hauek nahitaezkoak dira doitasun handiko integrazioak behar ditugunean.     

\paragraph*{}Atal hau bukatzeko, Sanz Sernaren  \ycite[1992]{Sanz-Serna1992} hitzak berreskuratuko ditugu. 
\begin{displayquote}
On the other hand, little has been undertaken in the construccion of practical high-order methods and the design of serious symplectic software is still waiting consideration.
\end{displayquote}

\section{Helburua eta esparrua.}

Gure helburua, eguzki-sistemaren epe luzeko integraziorako Gauss metodo inplizituaren inplementazio eraginkorra proposatzea da. Helburu hau lortzeko, honako aspektu hauek bereziki zainduko ditugu: eguzki-sistemaren problemaren ezaugarriak, biribiltze errorearen garapena eta egungo konputagailuen gaitasunari egokitutako algoritmo azkarren diseinua.  

N-gorputzeko problema grabitazionalari dagokionez, eguzki-sistemaren eredu sinplea integratuko dugu. Eguzki-sistemaren gorputzak masa puntualak kontsideratuko ditugu eta gure ekuazio diferentzialek, gorputz hauen arteko erakarpen grabitazionalak bakarrik kontutan hartuko dituzte. Beraz, eguzki-sistemaren eredu konplexuagoetako erlatibitate efektua, gorputzen formaren eragina, eta beste zenbait indar ez-grabitazionalak ez dira kontutan hartu.
Bestalde era honetako integrazioetan, gorputzen hasierako balio eta parametro zehatzak sateliteen bidez jasotako datu errealekin bat datozela egiaztatze prozesua ez dugu landu \cite{Laskar2015}.

Zeintzuk dira eguzki-sistemaren problemaren ezaugarri bereziak? Batetik, bi gorputzen problemaren  soluzio zehatza ezaguna da eta eguzki-sistemaren gorputzen mugimenduaren konputazioaren oinarria. Bestetik,  badugu gorputz nagusi bat (eguzkia) eta honen inguruan mugimenduan dauden gorputzak: barne planetak, masa txikikoak eta eguzkitik gertu daudenak ; kanpo planetak, masa handikoak eta eguzkitik urrun daudenak. Kanpo planeta nagusi hauen eboluzioa, eguzki-sistema osoaren zati garrantzitsuena da eta barne planeten mugimendua kontutan hartzeak ala ez, kanpo planeten zenbakizko integrazioarengan oso eragin txikia du. Eguzki-sistemaren egitura honi abantaila gehien ateratzen dion planteamendua bilatuko dugu.
  
Konputagailuen koma-higikorreko aritmetika ondo ulertzea garrantzitsua da. Zenbaki errealen adierazpen finitua erabiltzen denez, bai zenbakiak memorian gordetzerakoan, bai hauen arteko kalkulu aritmetikoak egiterakoan, biribiltze errorea sortzen da. Integrazio luzeetan, biribiltze errorea propagatzen da eta une batetik aurrera, soluzioen zuzentasuna ezereztatzen da. Zentzu honetan, doitasuna hobetzeko biribitze errorea gutxitzen duten teknika bereziak aplikatzea ezinbestekoa izaten da. Hala ere, integrazio luzeetan maiz doitasun handian lan egiteko beharra azaltzen zaigu baina doitasun altuko aritmetikaren ($128$-bit) inplementazioa software bidezkoa denez, oso motela da. Exekuzio denbora onargarriak lortzeko tarteko irtenbideak landu behar dira, hain zuzen ere, doitasun ezberdinak nahasten dituzten inplementazioak.       

Konputagailu teknologiaren garapenean, algoritmo azkarren diseinua baldintzatzen duten bi ezaugarri azpimarratu behar dira. Batetik, konputagailuak orokorrean paraleloak dira eta algoritmo azkarrak garatzeko, kodearen paralelizazio gaitasunari heldu behar zaio. Bestetik, konputazioaren alde garestiena, memoria eta prozesadorearen arteko datu mugimendua denez, prozesadorearen konputazio handiena komunikazio txikienarekin lortu behar da. 

Sarrera honetan paralelizazioari buruzko ohar batzuk ematea komeni da. Algoritmo baten kode unitateak paraleloan exekutatzeak badu gainkarga bat eta beraz,  algoritmoaren exekuzioa paralelizazioaz azkartzea lortzeko,  unitate bakoitzaren tamainak esanguratsua izan behar du. Gure eguzki-sistemaren eredua sinplea da eta logikoa da pentsatzea eredu konplexuagoetan, paralelizazioak abantaila handiagoa erakutsiko duela. Bestalde, $N$-gorputzen kopurua handia den problemetan, hauen arteko interakzio kopuru $\mathcal{O}(N^2)$ handia kalkulatu behar da eta indar hauen hurbilpena modu eraginkorrean kalkulatzeko metodo ezagunak daude: \textit {tree code}\cite{Barnes1986} eta \textit {fast multipole method}\cite{Carrier1988} izeneko metodoak. Baina gure probleman gorputz kopurua txikia denez, teknika hauek gure eremutik kanpo utzi ditugu. 


\section{Ekarpenak.}

Tesiaren lana hiru ataletan banatu dugu. Lehen urratsean, Gauss metodoaren puntu finkoko iterazioaren inplementazioa aztertu dugu eta gure inplementazioen oinarriak finkatu ditugu. Bigarren fasean, Gauss metodoaren Newton iterazioaren inplementazio eraginkorra lortzeko ahalegin berezia egin dugu. Problema zurruna denean, puntu finkoaren iterazio ez da eraginkorra eta Newton iterazioa aplikatu behar da. Gainera problema ez-zurruna izanik ere, Newton iterazioak interesgarriak izan daitezke; bereziki doitasun altuko (doitasun
laukoitza) konputazioetan iterazio metodoaren konbergentzi ezaugarri onak direla eta.  Hirugarren fasean ...

Jarraian, atal bakoitzean egindako ekarpena nagusienak laburtuko ditugu:

\begin{enumerate}
\item IRK puntu finkoa.

Gauss metodoaren puntu finkoko inplementazioaren azterketa sakon bat egin dugu eta horretarako, Hairer-en inplementazioa \cite{Hairer2008} hartu dugu gure lanaren abiapuntua. Kalitatezkoa inplementazio hau hobetzeko aukerak ikusi ditugu eta inplementazio sendoago bat proposatu dugu. Gure ekarpenak hauek izan dira:  

\begin{enumerate}
\item Metodoaren birformulazioa.

Gauss inplizitua aplikatzen dugunean, metodoa definitzen duten biribildutako koefiziente errealak ($\tilde{a}_{ij}, \tilde{b}_i \in \mathbb{F}$) erabiltzen dira. Formulazio estandarra erabiliz, koefiziente hauek ez dute metodoa sinplektikoa izateko baldintza zehazki betetzen eta beraz, izaera sinplektikoaren propietate onak galtzen dira. Metodoaren birformulazio baliokide bat proposatu dugu, non sinplektizidade baldintza zehazki beteko duten koefizieteak modu errezean finkatu daitezkeen.

\item Geratze erizpide berria.

Orokorrean, Hairer-en inplementazioaren puntu finkoko iterazioaren geratze erizpide zuzena dela ikusi dugu baina kasu batzuetan goizegi geratzen dela baieztatu dugu. Arrazoiak bi direla ikusirik, bere geratze erizpidea bi zentzutan garatu/zorroztu dugu. Lehenik, Hairer-en inplementazioan, hobekuntza neurtzeko ataletako diferentziaren norma batean oinarritzen da. Normaren independientea den geratze erizpidea aplikatzea zuzenagoa da, eta horregaitik, ataletako edozein osagaiaren diferentzia txikitzen den bitartean iterazioan jarraitzea finkatu dugu. Bigarrenik, iterazioen hobekuntza ez du zertan beherakorra izan behar, eta okertzen diren tarteko iterazioak gerta daitezke. Arazo hau gainditzeko, iterazioren batean osagai guztien diferentzia handitzea gertatzen denean, seguridadeko bi iterazio gehigarri emango ditugu, iteraziotik irten aurretik.   

\item Atalen espresioaren aldaketa.

Integrazioan batura konpensatu estandarra aplikatzen dugunean, zenbakizko soluzioa $\tilde{y}_n, e_n \in \mathbb{F}^d$ lortzen dugu non $\tilde{y}_n+e_n \approx y(t_n)$ den. Hori dela eta, metodoaren atalen espresioan $\tilde{y}_n$ ordez, $\tilde{y}_n+e_n$ erabiltzea proposatu dugu. Aldaketa honekin, zenbakizko soluzioaren doitasuna zerbait hobetuko dela espero da.

\begin{equation*}
Y_{n,i}=y_n + \left(e_n+ \sum_{j=1}^{s}\mu_{ij} L_{n,j} \right).
\end{equation*}
  
\item Biribiltze errorearen estimazioa.

Zenbakizko soluzioaren $\tilde{y}_n+e_n \approx y(t_n), \ n=1,2,\dots$ biribitze errorearen estimazioa, doitasun txikiagoko bigarren zenbakizko soluzioaren $\hat{y}_n+\hat{e}_n \approx y(t_n), \ n=1,2,\dots$  diferentzia gisa kalkulatuko dugu.
Erabiltzaileari zenbakizko soluzioaren estimazioa ezagutzeko, exekuzio bakarrean  eta \emph{CPU} gainkarga txikiarekin, bi integrazioak sekuentzialki kalkulatzeko aukera eskeiniko zaio. 


\end{enumerate}


\item IRK Newton.

\begin{enumerate}
\item Ekarpen nagusia.

Newton metodoa, $s$-ataletako IRK metodoarekin $d$-dimentsioko ekuazio diferentzial  sistemari aplikatzeko, urrats bakoitzean $sd \times sd$ tamaineko hainbat ekuazio sistema (iterazio bakoitzeko bat) askatu behar dira. Atal honetan, jatorrizko $sd$-dimentsioko ekuazio sistema, $(s+1)d$ sistema baliokide moduan berridatziko dugu eta sistema baliokidea,  $d \times d$ tamaineko $[s/2]+1$ matrize errealen \emph{LU}-deskonposaketa bidez askatuko dugu. Tamaina txikiko matrizeen LU-deskonposaketa azkarra denez, konputazionalki eraginkorragoa izatea espero dugu.   

\item Doitasun laukoitzeko inplementazioa.

Doitasun laukoitzeko exekuzioetan, funtzio ebaluaztapena oso garestia da eta funtzio ebaluaztapen kopurua gutxitzea bilatuko dugu. Newton osoa aplikatzen dugunean pena mereziko du, Gaussen Newton iterazioko inplementazioaren ekuazio lineala askatzeko metodo iteratiboa aplikatzea. 

\end{enumerate}
  

\item IRK Eguzki-sistema.

Hirugarren urratsean, eguzki-sistemaren epe luzeko integrazioan arituko gara. Ekarpen handiena, atalen hasieraketa berri bat aplikatzea da alde Kepleriarraren fluxuan oinarrituz. IRK metodoak eskaintzen digun malgutasunari esker eta N gorputzetako problema grabitazionalaren ezaugarriez baliatuz inplementazio ezberdinak egingo ditugu. Inplementazio hauen eraginkortasuna, egungo integratzaile simplektiko esplizituekin konparatuko ditugu.

\item Birparametrizazioa.

Azken urratsean, esperimentalki, eguzki-sistemaren integrazioan  denbora birparametrizazio teknikaren aplikazio sinple bat erakutsiko dugu. Integratzaile sinplektikoak luzera finkoko urratsa eduki behar du eta zentzu honetan, birparametrizazioa eraginkortasuna hobetzeko beste bide bat da.      

\end{enumerate}        


\section{Tesiaren egitura.}

Tesiaren lehenengo $(1-5)$ kapituluetan, zenbakizko integrazio sinplektikoak eta zientzia konputazionalaren oinarriak azaldu ditugu. Bigarren kapituluaren lehen zatian, \emph{Zenbakizko integratzaile sinplektikoen} inguruko oinarrizko kontzeptuak azaldu ditugu. Kapitulu honen bigarren zatian, Gauss metodo estandarra deskribitu eta bere propietaten nagusienak eman ditugu. Kapitulu honen azken zatian, eguzki-sistemaren integraziorako metodo sinplektiko eta esplizitu nagusienak laburtu ditugu. Hirugarren kapituluan, lan honetan zenbakizko esperimentuetan erabili ditugun hasierako baliodun problemen zehaztasunak eman ditugu. Laugarren kapituluan koma-higikorreko aritmetika murgidu gara eta biribiltze errorearen inguruko gaiak argitu nahi izan ditugu. Bostgarren kapituluan, egungo konputazio zientziaren hardware eta software kontzeptu nagusienak ezagutarazi nahi izan ditugu.     

Tesiaren $(6-8)$ kapituluetan, gure inplementazio berriak landu ditugu eta bakoitzaren konportamendua zenbazki esperimentuetan erakutsi dugu. Lehenik, $6$.~kapituluan Gauss metodoaren puntu finkoko iterazioaren inplementazio berria eman dugu. Ondoren, $7$.~kapituluan Gauss metodoaren Newton iterazioaren inplementazio eraginkorrak azaldu ditugu. $8$.~kapituluan, eguzki-sistemaren integraziorako inplementazio deskribapena egin dugu.  

Tesiaren $(9-10)$ kapituluetan, gure hipotesiaren eztabaida eta lanaren konklusioak idatzi ditugu.

Tesiaren bukaeran, hiru eranskinetan lanaren informazio osagarria bildu dugu. A-eranskinean, tesian zehar erabilitako hainbat frogen zehaztapenak eman dira. B-eranskinean, garatutako kodeak bildu eta erabiltzaileari erabilgarri izan daitekeen informazioa laburtu dugu. Azkenik C-eranskinean, erabilitako notazioaren inguruko argibideak eman ditugu.

      
      
\section{Laburpena}

