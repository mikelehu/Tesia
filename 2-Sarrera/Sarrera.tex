\chapter{Sarrera.}


\section{Ikerketaren testuingurua.}

Urte luzez, zientziaren arlo ezberdinek N-gorputzeko problema ikertu dute. Astronomoek eguzki-sistemaren planeten mugimendua ulertu nahian egindako lanak edo kimikariek erreakzio kimikoekin esperimentatzeko molekulen dinamikaren azterketak aipatu daitezke. Arlo bakoitzak bere lege fisikoak baditu ere, oinarrian problema berdina lantzen dute eta beraien arteko antzekotasunak handiak dira. Azpimarratu ere,  N-gorputzen problemaren azterketak garrantzi berezia izan duela matematikako eremu ezberdinen garapenean, esaterako dinamika ez-lineal eta kaos teorian. 

Garai batean, N-gorputzen problemak teori analitikoen bidez aztertzen ziren baina konputagailuen sorrerarekin, zenbakizko integrazioak tresna nagusia bilakatu ziren. Azken hamarkadetan, bai konputazio teknologien aurrerapenari esker bai algoritmo berrien sorrerari esker, zenbakizko azterketek garapen handia izan dute. Zenbakizko simulazioen laguntzaz, eguzki-sistemaren dinamikaren funtsezko galdera batzuk ezagutu ditugu eta berriki, Karplusen taldeak 2013. kimikako Nobel saria \cite{Karplus2014} jaso du kimika konputazionalean egindako lanarengatik.       

Guk lan honetan, N-gorputzen problema grabitazionala aztertuko dugu. Oro har eta gaia kokatzeko asmoarekin, N-gorputzen ohiko zenbakizko  integrazioak hiru taldeetan sailkatu ditzakegu:
\begin{enumerate}
{
\item Epe motzeko eta doitasun handiko integrazioak. 
 Eguzki-sistemaren efemeride zehatzak edo espazioko satelite artifizialen kokapenen kalkuluetarako erabili ohi dira.
\item Epe luzeko baina doitasun txikiko integrazioak.
 Denbora epe luzean planeta-sistemen mugimendu ezagutzeko egindako ikerketak ditugu. Azterketa hauetan, garrantzitsua  gorputzen mugimenduaren argazkia orokorra (zehaztasun handirik gabe) ezagutzea da. Normalean, problema mota hauetan gorputzen arteko kolisio gertuko egoerak ez dira izaten.     
\item N-gorputz kopurua edozein izanik, hauen arteko kolisioak gerta daitezkeen problemak.
 Integrazio hauetan, konplexutasun handiari aurre egin behar zaio. N-gorputz kopurua miliotakoa izan dateke eta kolisio gertuko egoeren ondorioz, kalkulutan egindako zenbakizko errore txikiek soluzioan eragin handia izan ditzakete.    
}
\end{enumerate}

Gure helburua eguzki-sistemaren epe luzeko eta doitasun handikoa algoritmoak garatzea da. Aurreko hamarkadetan, eguzki-sistemaren planeten epe luzeko zenbakizko integrazioa erronka garrantzitsua izan da. Adibidez, Sussmanek eta Wisdomek (1993) \cite{Sussman1992} eguzki sistemaren 100 milioiko integrazioarekin, planeten mugimendua kaotikoa zela baieztatu zuten. Aldi berean, paleoklimatologi-zientziak orain milioika urte gertatutako klima zikloak (epel-aroa, hotz-aroa eta glaziazio-aroa) azaltzeko, lurraren orbitan izandako aldaketaren eraginez gertatu zela azaltzen duen teoria (Milankovitch 1941) \cite{Berger2012} baieztatzeko planeten orbiten efemeride zehatzak beharrezkoak dira.        

Konputazio-teknologi aurrerapenak handiak izan arren, eguzki-sistemaren simulazio hauek konputazionalki oso garestiak dira eta exekuzio denbora luzeak behar dituzte; adibidez, Laskarrek \ycite[2010]{Laskar2011} bere azken integrazioa burutzeko 18 hilabete behar izan zituen. Azken urteotako konputagailu berrien arkitekturaren bilakaerak, algoritmo azkarren diseinua aldatu du: simulazioak azkartzeko algoritmoak paralelizazioan oinarritu behar dira eta eragiketa aritmetikoek baino kostu handiagoa du memorien arteko datu komunikazioak. Beraz, oraindik ere algoritmo eraginkorragoak beharrezkoak dira eta hauek garatzeko bide berriak ikertu behar dira.


\section{Motibazioa.}
\label{intro}

Epe luzeko integrazioetarako zenbakizko hainbat metodo erabiltzen dira, bereziki beren izaera Hamiltondarra mantentzen duten metodoak (metodo sinpletikoak). Metodo horien artean, gehien erabiltzen direnak izaera esplizituko algoritmoak dira.

Problema ez-stiffa denean, metodo esplizituak  metodo inplizituak baino eraginkorragoak kontsideratzen dira. Metodo inplizituetan ekuazio sistema ez-lineala askatu behar da, eta honek metodo esplizituekiko CPU denbora gainkarga suposatzen du. Horregatik problema ez-stiffa bada, metodo esplizituak erabili ohi dira eta problema stiff-a denean bakarrik jotzen dugu metodo inplizituengana. Baieztapen hau eztabaidagarria da, eta praktikan metodo inplizituetan gehiago sakondu behar dela iruditzen zaigu. 

Jarraian, metodo inplizituen ezaugarri interesgarri batzuk nabarmenduko ditugu. Abantaila nagusienetakoa malgutasuna da.  Metodo inplizituek inplementazio malgua onartzen dute eta ondorioz, integratu nahi dugun problemari egokitzeko aukera gehiago eskaintzen dizkigu. Aipatzekoa da ere, metodo esplizituak sistema Hamiltondar banagarrietan bakarrik aplika daitezke eta Hamiltondarraren egitura hau aprobetxatuz oso eraginkorrak direla. Metodo inplizituak aldiz, Hamiltondar orokorrei aplika daitezke eta gainera, lehen ordenako ekuazio diferentzialetarako  metodo sinpletikoak inplizituak izan behar dira.  Azkenik ez dugu ahaztu behar, metodo inplizituen artean orden altuko metodoak existitzen direla  eta hauek nahitaezkoak dira doitasun handiko integrazioak behar ditugunean.     

Lan honetan, metodo inplizituen artean Gauss zenbakizko integrazio metodoa aukeratu dugu. Hainbat autorek (Hairer \cite{Hairer2006}\cite{Hairer2008} eta Sanz Serna\cite{JMSanz-Serna1994}) metodo honen potentziala nabarmendu dute eta guk ere, iritzi berekoak gara. Laburki aipatuz, $s$ ataletako metodo hau $2s$ ordenekoa da, sinpletikoa da, egonkortasun ezaugarri onak ditu eta paralizatzeko gaitasuna ahaztu gabe.      

\section{Helburua eta esparrua.}

Gure helburua, eguzki-sistemaren ebazpenerako Gauss inplizituaren inplementazio eraginkorra proposatzea da. Hau lortzeko  bereziki honako aspektu hauek kontutan izango ditugu: eguzki-sistemaren problemaren ezaugarriak, konputagailuen koma-higikorreko aritmetika eta algoritmo paraleloen abantailak.  

N-gorputzeko problema grabitazionalari dagokionez, eguzki-sistemaren eredu sinplea integratuko dugu. Eguzki-sistemaren gorputzak masa puntualak kontsideratuko ditugu eta gure ekuazio diferentzialek, gorputz hauen arteko erakarpen grabitazionalak bakarrik kontutan hartzen dituzte. Beraz, eguzki-sistemaren eredu konplexuagoetako erlatibitate efektua, gorputzen formaren eragina, eta beste zenbait indar ez-grabitazionalak ez dira kontutan hartu.
Bestalde era honetako integrazioetan, gorputzen hasierako balio eta parametro zehatzak sateliteen bidez jasotako datu errealekin bat datozela egiaztatze prozesua ez dugu landu.

Zeintzuk dira eguzki-sistemaren problemaren ezaugarri bereziak? Batetik bi gorputzen problemaren (Keplerren problema) soluzioa zehatza ezaguna da eta eguzki-sistemaren gorputzen mugimenduaren konputazioaren oinarria. Bestetik,  badugu gorputz nagusi bat (eguzkia) eta honen inguruan mugimenduan dauden gorputzak: barne planetak, masa txikikoak eta eguzkitik gertu daudenak ; kanpo planetak, masa handikoak eta eguzkitik urrun daudenak (ikus irudia Fig.\ref{fig:plot1}). Eguzki-sistemaren egitura honi abantaila handien lortzen duen planteamendua bilatuko dugu.


\begin{figure}[h]
\centering
\subfloat[Planeten arteko distantziak.]{
\includegraphics[width=.500\textwidth]{eguzkisistema1}
}
\subfloat[Planeten arteko masa konparaketa.]{
\includegraphics[width=.500\textwidth]{eguzkisistema2}
}
\caption[Eguzki-sistema]{\small Eguzki-sistema.}
\label{fig:plot1}
\end{figure}    
   
Konputagailuen koma-higikorreko aritmetika ondo ulertzea garrantzitsua da. Zenbaki errealen adierazpen finitua erabiltzen denez bai zenbakiak memorian gordetzerakoan, bai hauen arteko kalkulu aritmetikoak egiterakoan, errore bat egiten dugu. Integrazio luzeetan errore hau propagatzen da eta une batetik aurrera, soluzioen zuzentasuna ezereztatzen da. Ondorioz, integrazioan zehar errore honen monitorizazioa ezagutzea interesgarria da eta integrazio luzeen kasuan, doitasun handian lan egiteko beharra azaltzen zaigu. Doitasun altuko aritmetiken erabilera oso garestia da, inplementazioa software bidezkoa delako. Exekuzio denborak onargarriak lortzeko tarteko irtenbidea, inplementazioan doitasun ezberdinak nahastea izango litzateke.       

Sarrera honetan paralelizazioari buruzko ohar bat ematea komeni da. Algoritmo baten kode unitateak paraleloan exekutatzeak badu gainkarga bat eta beraz,  algoritmoaren exekuzioa paralelizazioaz azkartzea lortzeko,  unitate bakoitzaren tamainak esanguratsua izan behar du. Gure eguzki-sistemaren eredua sinplea da eta logikoa da pentsatzea eredu konplexuagoetan, paralelizazioak abantaila handiagoa erakutsiko duela. Bestalde, $N$-gorputzen kopurua handia den problemetan, hauen arteko interakzio kopuru $O(N^2)$ handia kalkulatu behar da eta indar hauen hurbilpena modu eraginkorrean kalkulatzeko metodo ezagunak daude: \textit {tree code}\cite{Barnes1986} eta \textit {fast multipole method}\cite{Carrier1988}. Baina gure probleman gorputz kopurua txikia denez, teknika hauek gure eremutik kanpo utzi ditugu. 


\section{Ekarpenak.}

\section{Tesiaren egitura.}

Gure lanaren abiapuntua Hairer-en IRK metodoaren inplementazioa da \cite{Hairer2008}. Autoreak IRK puntu-finkoaren inplementazio estandarrean biribiltze errorearen okerreko portaeraz jabetu zen eta arazo hau konpontzeko soluzioa proposatu zuen. Lehen urratsa honetan, biribiltze errorearen arazoari soluzio berri bat eman diogu eta gure IRK inplementazioaren oinarriak finkatu: formulazio, koefizienteak, geratze irizpidea,atalen hasieraketa \dots.
Gure inplementazioak biribiltze errorea propagazioa optimotik gertu dagoela baieztatzeko, \emph{integratzaile idealaren} soluzioarekin konparatu dugu. Aldi berean, integratzailean biribiltze errorearen estimazioa monitorizatzeko aukera garatuko dugu.

Bigarren urratsean, ekuazio sistema ez-lineala ebazteko puntu-finkoaren ordez, Newton sinplifikatuaren metodoa aztertu dugu. Gure ekarpena, Newton sinplifikatua modu eraginkorrean aplikatzeko teknika proposatzea izango da. S-ataletako IRK metodoa eta d-dimentsioko EDA badugu, Newton sinplifikatuaren metodoren iterazio bakoitzean ($sdxsd$) tamainako sistema lineala askatu behar da. Gure proposamena da, jatorrizko sistema lineala blokeka diagonala den sistema baliokide gisa berridaztea eta matrizearen egitura hau aprobetxatu sistema modu eraginkorrean askatzeko.

Hirugarren urratsean, eguzki-sistemaren epe luzeko integrazioan arituko gara. Ekarpen handiena, atalen hasieraketa berri bat aplikatzea da alde Kepleriarraren fluxuan oinarrituz. IRK metodoak eskaintzen digun malgutasunari esker eta N gorputzetako problema grabitazionalaren ezaugarriez baliatuz inplementazio ezberdinak egingo ditugu. Inplementazio hauen eraginkortasuna, egungo integratzaile simplektiko esplizituekin konparatuko ditugu.

Azken urratsean, esperimentalki, eguzki-sistemaren integrazioan  denbora birparametrizazio teknikaren aplikazio sinple bat erakutsiko dugu. Integratzaile sinpletikoak luzera finkoko urratsa eduki behar du eta zentzu honetan, birparametrizazioa eraginkortasuna hobetzeko beste bide bat da.             
      
\section{Laburpena}

